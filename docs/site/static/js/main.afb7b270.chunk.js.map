{"version":3,"sources":["store/index.js","pages/index.js","components/FormEditor.js","components/FormRoot.js","helpers/builder.js","pages/TileSelector.js","helpers/utils.js","store/forms.js","pages/FormDesigner.js","helpers/model.js","index.js","components/ApplicationContainer.js"],"names":["_react","_interopRequireWildcard","__webpack_require__","_storeon","_interopRequireDefault","_context","_utils","_forms","_ref","children","_ref$store","store","defaultStore","checkNotNil","default","createElement","Provider","value","Fragment","createDefaultStore","_len","arguments","length","stores","Array","_key","concat","process","forms","_FormDesigner","_TileSelector","_immer","_lodashEs","_fannypack","_reactFontawesome","_freeSolidSvgIcons","_FormRoot","_ref$model","model","simpleFormModel","_ref$prefs","prefs","options","otherProps","_objectWithoutProperties2","_useState","useState","_useState2","_slicedToArray2","formModel","setFormModel","_useState3","_useState4","formPrefs","setFormPrefs","localTheme","defaultLocalTheme","formContext","defaultFormContext","produce","context","registry","FormPart","EditorFormPart","useEffect","console","log","ContextProvider","Box","Object","assign","_paddingTop","paddingLeft","paddingRight","color","FormRoot","rootModel","_ref2","node","path","useContext","FormContext","isSelected","selectedFieldset","isFieldSelected","includes","isActive","pointerPrefs","_objectSpread2","pointer","header","Text","title","use","fontSizesHeader","fontSize","split","rowPadding","paddingPx","marginLeft","marginRight","type","DropBox","gridColumn","name","_onDragOver","onDragOver","_onDrop","event","onDrop","position","Flex","column","alignItems","top","left","width","FontAwesomeIcon","icon","faTrashAlt","size","faGripLinesVertical","onClick","stopPropagation","backgroundColor","undefined","get","opacity","pointerEvents","paddingBottom","Heading","paddingTop","display","gridTemplateColumns","gridColumnGap","gridRowGap","DragBox","_onMouseOver","onMouseOver","_onDragStart","onDragStart","InputField","label","slice","defaultValue","readOnly","Error","_ref3","_ref4","draggable","currentTarget","dataTransfer","setData","emptyImage","Image","src","setDragImage","preventDefault","data","getData","point","x","nativeEvent","clientX","y","clientY","clientRect","getBoundingClientRect","bounds","height","_ref$rootView","rootView","_useContext","queryComponent","FormObject","_useContext2","items","FormArray","_useContext3","map","item","index","key","margin","padding","Code","createFormPartType","datatype","types","compact","join","toLowerCase","React","createContext","_ref5","_ref5$localTheme","_ref5$formContext","ThemeProvider","theme","Pane","base","css","_templateObject","h2","_templateObject2","Label","_templateObject3","Input","_templateObject4","focus","_templateObject5","definitionFn","fieldset","field","buildDefinition","payload","_lodash","_jsonSchemaWalker","_model","schema","fieldsetIndex","fieldIndex","currentParentPointer","traverseSchema","object","parentObject","toPointer","parentPointer","isFieldsetType","objectPathSegments","push","objectPath","toObjectPath","pick","set","isRootPointer","nextChildIndex","rewritePathSegment","currentEntry","unshift","rootObjectPath","root","pathSegments","visitFn","schemaWalk","schemaObject","parentSchemaObject","parentPath","_react2","_useReactRouter2","_useLocalStorage5","_luxon","_freeRegularSvgIcons","_extends2","_useReactRouter","useRef","history","_useStoreon","location","match","dispatch","_useLocalStorage","_useLocalStorage2","version","setVersion","_useLocalStorage3","_useLocalStorage4","localForms","setLocalForms","id","updatedAt","DateTime","local","toISO","orderSchema","taskSchema","FORMS_CREATE","border","fontFamily","maxWidth","minHeight","Set","isFilled","spacing","marginTop","Tile","dashed","cursor","pathname","Link","href","row","justifyContent","faPlusCircle","form","now","past","fromISO","durationText","formatDuration","diff","marginBottom","faFileAlt","className","_ref2$dashed","borderRadius","duration","pluralize","singular","plural","timeUnits","months","days","hours","minutes","seconds","timeSpans","shiftTo","apply","_toConsumableArray2","keys","toObject","_i","_Object$keys","timeUnit","round","condition","message","isNil","_ref$indent","indent","style","whiteSpace","wordWrap","pretty","JSON","stringify","it","trim","Symbol","FORMS_CREATED","on","isReady","_asyncToGenerator2","_regenerator","mark","_callee","state","wrap","prev","next","stop","_x","this","_objectDestructuringEmpty2","_FormEditor","_builder","_ref$nested","nested","createFormPrefs","find","String","params","formId","buildModel","buildFlatModel","borderTop","#/","#/properties/customer","#/properties/customer/properties/customerNumber","#/properties/customer/properties/firstName","#/properties/customer/properties/lastName","#/properties/orderItems","#/properties/orderItems/items","#/properties/shippingAddress","$schema","properties","orderNumber","string","orderDate","customer","customerNumber","firstName","lastName","orderItems","array","productNumber","quantity","integer","unitPrice","shippingAddress","street","city","country","zip","totalPrice","number","required","tasks","description","details","done","boolean","taskModel","schemaPaths","fullPath","_reactDom","_ApplicationContainer","rootNode","document","querySelector","ReactDOM","render","_reactRouterDom","_store","_pages","ApplicationContextProvider","ApplicationRoutes","HashRouter","Switch","Route","exact","component","TileSelector","FormDesigner","ApplicationContext","_ref$theme","applicationTheme","StoreContextProvider","isStandalone","defaultTheme","global"],"mappings":"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","file":"static/js/main.afb7b270.chunk.js","sourcesContent":["import React, { Fragment } from \"react\"\nimport createStore from \"storeon\"\nimport StoreContext from \"storeon/react/context\"\nimport { check, checkNotNil } from \"../helpers/utils\"\nimport forms from \"./forms\"\n\nexport const StoreContextProvider = ({ children, store = defaultStore }) => {\n  checkNotNil(store, () => \"store context needs a store.\")\n  return (\n    <StoreContext.Provider value={store}>\n      <Fragment>{children}</Fragment>\n    </StoreContext.Provider>\n  )\n}\n\nconst devtoolsOptions = {\n  features: {\n    pause: false,\n    lock: false,\n    import: false,\n    export: false,\n  },\n}\n\nexport const createDefaultStore = (...stores) => {\n  return createStore([\n    ...stores,\n    process.env.NODE_ENV !== \"production\" &&\n      require(\"storeon/devtools\")(devtoolsOptions),\n    process.env.NODE_ENV !== \"production\" && require(\"storeon/devtools/logger\"),\n  ])\n}\n\nexport const defaultStore = createDefaultStore(forms)\n","import FormDesigner from \"./FormDesigner\"\nimport TileSelector from \"./TileSelector\"\n\nexport { FormDesigner, TileSelector }\n","import React, { Fragment, useState, useEffect, useContext } from \"react\"\nimport { produce } from \"immer\"\nimport { get } from \"lodash-es\"\nimport { Box, Flex, Heading, Text, InputField } from \"fannypack\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport {\n  faTrashAlt,\n  faGripLinesVertical,\n} from \"@fortawesome/free-solid-svg-icons\"\nimport {\n  FormRoot,\n  FormContext,\n  ContextProvider,\n  defaultFormContext,\n  defaultLocalTheme,\n  simpleFormModel,\n} from \"./FormRoot\"\nimport { pretty } from \"../helpers/utils\"\n\nexport default ({\n  model = simpleFormModel(),\n  prefs = { options: {} },\n  ...otherProps\n}) => {\n  const [formModel, setFormModel] = useState(model)\n  const [formPrefs, setFormPrefs] = useState(prefs)\n  const localTheme = defaultLocalTheme()\n  const formContext = defaultFormContext(\n    produce(context => {\n      context.registry.FormPart = EditorFormPart\n      context.formModel = formModel\n      context.setFormModel = setFormModel\n      context.formPrefs = formPrefs\n      context.setFormPrefs = setFormPrefs\n    })\n  )\n  useEffect(() => {\n    console.log(\"form model changed\")\n    // console.log(\"form model changed\", pretty(formModel))\n  }, [formModel])\n  return (\n    <ContextProvider formContext={formContext} localTheme={localTheme}>\n      <Box\n        _paddingTop=\"major-2\"\n        paddingLeft=\"major-2\"\n        paddingRight=\"major-2\"\n        color=\"#121212\"\n        {...otherProps}\n      >\n        <FormRoot rootModel={formModel} />\n      </Box>\n    </ContextProvider>\n  )\n}\n\nexport const EditorFormPart = ({ node, path, children }) => {\n  const context = useContext(FormContext)\n\n  const onSelectClick = event => {\n    context.setFormPrefs(\n      produce(formPrefs => {\n        const selectedFieldset =\n          formPrefs.selectedFieldset === path ? null : path\n        formPrefs.selectedFieldset = selectedFieldset\n      })\n    )\n    event.stopPropagation()\n  }\n  const isSelected = path === context.formPrefs.selectedFieldset\n  const isFieldSelected = path.includes(context.formPrefs.selectedFieldset)\n  const isActive = context.formPrefs.selectedFieldset ? isFieldSelected : true\n  const passiveOpacity = \"0.5\"\n\n  const pointerPrefs = {\n    ...context.formPrefs[node.pointer],\n  }\n  const header = node.pointer ? (\n    <Text>\n      {node.title} <Text use=\"small\">{node.pointer}</Text>\n    </Text>\n  ) : null\n\n  const fontSizesHeader = context.formPrefs.options.fontSizesHeader\n  const fontSize = fontSizesHeader\n    ? fontSizesHeader[path.split(\".\").length]\n    : null\n\n  const rowPadding = paddingPx => {\n    return {\n      paddingLeft: `${paddingPx}`,\n      paddingRight: `${paddingPx}`,\n      marginLeft: `-${paddingPx}`,\n      marginRight: `-${paddingPx}`,\n    }\n  }\n\n  if (node.type === \"fieldset\") {\n    return (\n      <DropBox\n        gridColumn={pointerPrefs.gridColumn}\n        name={path}\n        _onDragOver={onDragOver}\n        _onDrop={event => onDrop(event, path)}\n        position=\"relative\"\n      >\n        {isSelected && (\n          <Fragment>\n            <Flex\n              column\n              alignItems=\"center\"\n              position=\"absolute\"\n              top=\"10px\"\n              left=\"-50px\"\n              width=\"20px\"\n            >\n              <FontAwesomeIcon icon={faTrashAlt} size=\"lg\" color=\"#d70004\" />\n            </Flex>\n            <Flex\n              column\n              alignItems=\"center\"\n              position=\"absolute\"\n              top=\"50%\"\n              left=\"-50px\"\n              width=\"20px\"\n            >\n              <FontAwesomeIcon\n                icon={faGripLinesVertical}\n                size=\"lg\"\n                color=\"#aaaaaa\"\n              />\n            </Flex>\n          </Fragment>\n        )}\n        <Box\n          {...rowPadding(\"16px\")}\n          onClick={onSelectClick}\n          backgroundColor={isSelected ? \"#fbd9d2\" : undefined}\n        >\n          {header && (\n            <Box\n              {...rowPadding(\"16px\")}\n              color={get(pointerPrefs, \"header.color\")}\n              backgroundColor={get(pointerPrefs, \"header.backgroundColor\")}\n              opacity={!isActive ? passiveOpacity : null}\n              pointerEvents={!isActive ? \"none\" : null}\n              paddingBottom=\"8px\"\n            >\n              <Heading\n                use=\"h2\"\n                paddingTop=\"8px\"\n                paddingBottom=\"8px\"\n                fontSize={fontSize}\n              >\n                <Fragment>{header}</Fragment>\n              </Heading>\n            </Box>\n          )}\n          {children && (\n            <Box\n              {...rowPadding(\"16px\")}\n              color={get(pointerPrefs, \"body.color\")}\n              backgroundColor={get(pointerPrefs, \"body.backgroundColor\")}\n              display=\"grid\"\n              gridTemplateColumns={pointerPrefs.gridTemplateColumns}\n              gridColumnGap=\"16px\"\n              gridRowGap=\"0\"\n            >\n              {children}\n            </Box>\n          )}\n        </Box>\n      </DropBox>\n    )\n  }\n  if (node.type === \"field\") {\n    return (\n      <DragBox\n        gridColumn={pointerPrefs.gridColumn}\n        name={path}\n        _onMouseOver={event => onMouseOver(event, path)}\n        _onDragStart={event => onDragStart(event, path)}\n      >\n        <Box\n          paddingBottom=\"16px\"\n          opacity={!isActive ? passiveOpacity : null}\n          pointerEvents={!isActive ? \"none\" : null}\n        >\n          <InputField\n            label={node.pointer.split(\"/\").slice(-1)[0]}\n            defaultValue={node.pointer}\n            readOnly\n          />\n        </Box>\n      </DragBox>\n    )\n  }\n  throw new Error(\"node.type handler not defined\")\n}\n\nexport const DropBox = ({ children, name, ...otherProps }) => {\n  return <Box {...otherProps}>{children}</Box>\n}\n\nexport const DragBox = ({ children, name, ...otherProps }) => {\n  return (\n    <Box draggable {...otherProps}>\n      {children}\n    </Box>\n  )\n}\n\nconst onDragStart = (event, path) => {\n  console.log(\"drag start:\", path, event.currentTarget)\n  event.dataTransfer.setData(\"path\", path)\n\n  const emptyImage = new Image()\n  emptyImage.src =\n    \"data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=\"\n  event.dataTransfer.setDragImage(emptyImage, 0, 0)\n}\n\nconst onDragOver = (event, path) => {\n  event.preventDefault()\n}\n\nconst onDrop = (event, path) => {\n  event.preventDefault()\n  const data = event.dataTransfer.getData(\"path\")\n  console.log(\"drop:\", path, event.currentTarget, data)\n  const point = {\n    x: event.nativeEvent.clientX,\n    y: event.nativeEvent.clientY,\n  }\n  const clientRect = event.currentTarget.getBoundingClientRect()\n  const bounds = {\n    x: clientRect.x,\n    y: clientRect.y,\n    width: clientRect.width,\n    height: clientRect.height,\n  }\n  console.log(\"drop point and bounds:\", point, bounds)\n}\n\nconst onMouseOver = (event, path) => {}\n\nconst arrayMoveMutate = (array, indexFrom, indexTo) => {\n  array.splice(\n    indexTo < 0 ? array.length + indexTo : indexTo,\n    0,\n    array.splice(indexFrom, 1)[0]\n  )\n}\n","import React, { Fragment, useContext } from \"react\"\nimport { Box, Text, Code, ThemeProvider, css } from \"fannypack\"\nimport { compact } from \"lodash-es\"\nimport \"typeface-open-sans\"\nimport \"typeface-open-sans-condensed\"\n\n//------------------------------------------------------------------------------\n// FORM COMPONENTS.\n//------------------------------------------------------------------------------\n\nexport const FormRoot = ({ rootModel, rootView = null }) => {\n  const { registry, queryComponent } = useContext(FormContext)\n  return (\n    <Box\n      use={rootView || queryComponent(registry, \"FormObject\", rootModel)}\n      node={rootModel}\n      path={`root`}\n    />\n  )\n}\n\nexport const FormObject = ({ node, path }) => {\n  const { registry, queryComponent } = useContext(FormContext)\n  return (\n    <Box\n      use={queryComponent(registry, \"FormPart\", node)}\n      node={node}\n      path={path}\n    >\n      {node.children && (\n        <Box\n          use={queryComponent(registry, \"FormArray\", node.children)}\n          items={node.children}\n          path={`${path}.children`}\n        />\n      )}\n    </Box>\n  )\n}\n\nexport const FormArray = ({ items, path }) => {\n  const { registry, queryComponent } = useContext(FormContext)\n  return items.map((item, index) => (\n    <Fragment key={`${path}[${index}]`}>\n      <Box\n        use={queryComponent(registry, \"FormObject\", item)}\n        node={item}\n        path={`${path}[${index}]`}\n      />\n    </Fragment>\n  ))\n}\n\nexport const FormPart = ({ node, path, children }) => {\n  return (\n    <Box>\n      <Box\n        margin=\"major-1\"\n        padding=\"major-1\"\n        backgroundColor=\"danger\"\n        color=\"white\"\n      >\n        <Text>\n          Error: <Code>&lt;FormPart&gt;</Code> for type{\" \"}\n          <Code>{createFormPartType(node.type, node.datatype)}</Code> at path{\" \"}\n          <Code>{path}</Code> not found.\n        </Text>\n      </Box>\n      <Box>{children}</Box>\n    </Box>\n  )\n}\n\nexport const createFormPartType = (...types) => {\n  return compact(types)\n    .join(\"-\")\n    .toLowerCase()\n}\n\n//------------------------------------------------------------------------------\n// FORM CONTEXT.\n//------------------------------------------------------------------------------\n\nexport const FormContext = React.createContext(null)\n\nexport const ContextProvider = ({\n  localTheme = null,\n  formContext = null,\n  children,\n}) => {\n  return (\n    <ThemeProvider theme={localTheme}>\n      <FormContext.Provider value={formContext}>\n        <Fragment>{children}</Fragment>\n      </FormContext.Provider>\n    </ThemeProvider>\n  )\n}\n\nexport const defaultFormContext = (modifyFormContext = context => context) => {\n  const context = {\n    registry: { FormObject, FormArray, FormPart },\n    queryComponent(registry, name, data) {\n      return registry[name]\n    },\n  }\n  return modifyFormContext(context)\n}\n\nexport const defaultLocalTheme = (modifyLocalTheme = theme => theme) => {\n  return modifyLocalTheme(localTheme)\n}\n\nexport const localTheme = {\n  Pane: {\n    base: css`\n      font-family: \"open sans\";\n      border-radius: 0;\n    `,\n  },\n  Heading: {\n    h2: css`\n      font-family: \"open sans condensed\";\n      font-size: 20px;\n      line-height: unset;\n      & small {\n        font-size: 14px;\n        font-family: \"open sans\";\n        font-weight: normal;\n      }\n    `,\n  },\n  Label: {\n    base: css`\n      font-family: \"open sans condensed\";\n      font-size: 16px;\n    `,\n  },\n  Input: {\n    base: css`\n      font-family: \"open sans\";\n      font-size: 14px;\n      line-height: unset;\n      border: 1px solid #cccccc !important;\n      border-radius: 0;\n      box-shadow: unset !important;\n      height: 40px;\n      padding: 0 15px;\n    `,\n    focus: css`\n      outline: unset !important;\n      box-shadow: unset !important;\n      border: unset;\n    `,\n  },\n}\n\n//------------------------------------------------------------------------------\n// FORM MODEL.\n//------------------------------------------------------------------------------\n\nexport const buildFormModel = definitionFn => {\n  const helpers = { fieldset, field }\n  return definitionFn(helpers)\n}\nexport const buildDefinition = (type, payload) => {\n  return { type, ...payload }\n}\nexport const fieldset = (datatype, payload = {}) =>\n  buildDefinition(\"fieldset\", { datatype, ...payload })\nexport const field = (datatype, payload = {}) =>\n  buildDefinition(\"field\", { datatype, ...payload })\n\nexport const simpleFormModel = () => {\n  return fieldset(\"object\", {\n    pointer: \"#/\",\n    title: \"order\",\n    children: [\n      field(\"string\", {\n        pointer: \"#/properties/orderNumber\",\n      }),\n      field(\"string\", {\n        pointer: \"#/properties/orderDate\",\n      }),\n      fieldset(\"object\", {\n        pointer: \"#/properties/customer\",\n        title: \"customer\",\n        children: [\n          field(\"string\", {\n            pointer: \"#/properties/customer/properties/customerNumber\",\n          }),\n          field(\"string\", {\n            pointer: \"#/properties/customer/properties/firstName\",\n          }),\n          field(\"string\", {\n            pointer: \"#/properties/customer/properties/lastName\",\n          }),\n        ],\n      }),\n    ],\n  })\n}\n","import { get, set, pick, concat } from \"lodash\"\nimport { schemaWalk } from \"@cloudflare/json-schema-walker\"\nimport { fieldset, field } from \"./model\"\nimport { pretty1 } from \"./utils\"\n\n/**\n * Builds a flat model using a json schema.\n */\nexport const buildFlatModel = schema => {\n  const registry = {\n    fieldsetIndex: -1,\n    fieldIndex: -1,\n    currentParentPointer: null,\n  }\n  const model = fieldset(\"array\")\n  traverseSchema(schema, (object, parentObject) => {\n    const pointer = toPointer(concat(parentObject.path, object.path))\n    const parentPointer = toPointer(parentObject.path)\n    const type = object.schema.type\n\n    if (!isFieldsetType(type) && parentPointer !== registry.currentParentPointer) {\n      registry.fieldsetIndex += 1\n      registry.fieldIndex = -1\n      registry.currentParentPointer = parentPointer\n\n      const objectPathSegments = []\n      objectPathSegments.push(`children[${registry.fieldsetIndex}]`)\n      const objectPath = toObjectPath(concat(...objectPathSegments))\n      // console.log(pretty1([objectPath, parentPointer]))\n\n      const payload = pick(parentObject.schema, [\"title\"])\n      const node = fieldset(parentObject.schema.type, { pointer: parentPointer, ...payload })\n      set(model, objectPath, node)\n    }\n\n    if (isFieldsetType(type)) {\n      registry.fieldsetIndex += 1\n      registry.fieldIndex = -1\n      registry.currentParentPointer = pointer\n    } else {\n      registry.fieldIndex += 1\n    }\n\n    const objectPathSegments = []\n    objectPathSegments.push(`children[${registry.fieldsetIndex}]`)\n    if (!isFieldsetType(type)) {\n      objectPathSegments.push(`children[${registry.fieldIndex}]`)\n    }\n    const objectPath = toObjectPath(concat(...objectPathSegments))\n    // console.log(pretty1([objectPath, pointer]))\n\n    if (isFieldsetType(type)) {\n      const payload = pick(object.schema, [\"title\"])\n      const node = fieldset(type, { pointer, ...payload })\n      set(model, objectPath, node)\n    } else {\n      const payload = pick(object.schema, [\"title\"])\n      const node = field(type, { pointer, ...payload })\n      set(model, objectPath, node)\n    }\n  })\n  return model\n}\n\n/**\n * Builds a nested model using a json schema.\n */\nexport const buildModel = schema => {\n  const registry = {}\n  const model = {}\n  traverseSchema(schema, (object, parentObject) => {\n    const pointer = toPointer(concat(parentObject.path, object.path))\n    const parentPointer = toPointer(parentObject.path)\n    const type = object.schema.type\n\n    if (isRootPointer(pointer, parentPointer)) {\n      registry[pointer] = {\n        parentPointer: null,\n        path: null,\n        index: 0,\n        nextChildIndex: 0,\n      }\n    } else {\n      registry[pointer] = {\n        parentPointer,\n        path: object.path,\n        index: registry[parentPointer].nextChildIndex,\n        nextChildIndex: 0,\n      }\n      registry[parentPointer].nextChildIndex += 1\n    }\n\n    const rewritePathSegment = ({ path, index }) => {\n      // return path || []\n      return path ? [\"children\", index] : []\n    }\n\n    const objectPathSegments = []\n    let currentEntry = registry[pointer]\n    while (currentEntry) {\n      objectPathSegments.unshift(rewritePathSegment(currentEntry))\n      currentEntry = registry[currentEntry.parentPointer]\n    }\n    const objectPath = toObjectPath(concat(...objectPathSegments))\n    const rootObjectPath = objectPath ? \"root.\" + objectPath : \"root\"\n    // console.log(pretty1([objectPath, pointer]))\n\n    if (isFieldsetType(type)) {\n      const payload = pick(object.schema, [\"title\"])\n      const node = fieldset(type, { pointer, ...payload })\n      set(model, rootObjectPath, node)\n    } else {\n      const payload = pick(object.schema, [\"title\"])\n      const node = field(type, { pointer, ...payload })\n      set(model, rootObjectPath, node)\n    }\n  })\n  return model.root\n}\n\nexport const isFieldsetType = type => {\n  return type === \"object\" || type === \"array\"\n}\n\nexport const isRootPointer = (pointer, parentPointer) => {\n  return pointer === parentPointer\n}\n\nexport const toPointer = pathSegments => {\n  return `#/${pathSegments.join(\"/\")}`\n}\n\nexport const toObjectPath = pathSegments => {\n  return pathSegments.join(\".\")\n}\n\nexport const traverseSchema = (schema, visitFn) => {\n  schemaWalk(schema, (schemaObject, path, parentSchemaObject, parentPath) => {\n    const object = { schema: schemaObject, path: path }\n    const parentObject = { schema: parentSchemaObject, path: parentPath }\n    visitFn(object, parentObject)\n  })\n}\n","import React, { Fragment, useEffect, useState, useRef } from \"react\"\nimport { Box, Pane, Flex, Set, Heading, Text, Link } from \"fannypack\"\nimport useStoreon from \"storeon/react\"\nimport useReactRouter from \"use-react-router\"\nimport useLocalStorage from \"react-use/lib/useLocalStorage\"\nimport { round } from \"lodash\"\nimport { DateTime } from \"luxon\"\nimport \"typeface-open-sans\"\nimport \"typeface-open-sans-condensed\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport { faPlusCircle } from \"@fortawesome/free-solid-svg-icons\"\nimport { faFileAlt } from \"@fortawesome/free-regular-svg-icons\"\nimport { FORMS_CREATE } from \"../store/forms\"\nimport { orderSchema, taskSchema } from \"./FormDesigner\"\nimport html2canvas from \"html2canvas\"\n\nexport default ({ ...otherProps }) => {\n  const ref = useRef(null)\n  const { history, location, match } = useReactRouter()\n  const { dispatch, forms } = useStoreon(\"forms\")\n  const currentVersion = 3\n  const [version, setVersion] = useLocalStorage(\n    \"monomodel.version\",\n    null\n  )\n  const [localForms, setLocalForms] = useLocalStorage(\"monomodel.forms\", [])\n\n  useEffect(() => {\n    if (version !== currentVersion) {\n      setVersion(currentVersion)\n      setLocalForms([\n        {\n          id: 1,\n          name: \"orderSchema form\",\n          updatedAt: DateTime.local(2019, 4, 27, 12, 0, 0).toISO(),\n          schema: orderSchema,\n        },\n        {\n          id: 2,\n          name: \"taskSchema form\",\n          updatedAt: DateTime.local(2019, 4, 1, 12, 0, 0).toISO(),\n          schema: taskSchema,\n        },\n      ])\n    }\n  }, [version])\n\n  useEffect(() => {\n    dispatch(FORMS_CREATE)\n  }, [])\n\n  // useEffect(() => {\n  //   if (ref.current) {\n  //     html2canvas(ref.current).then(function(canvas) {\n  //       document.body.appendChild(canvas)\n  //     })\n  //   }\n  // }, [ref.current])\n\n  return (\n    <Box\n      backgroundColor=\"#f7f7f8\"\n      paddingLeft=\"major-5\"\n      paddingRight=\"major-5\"\n      paddingBottom=\"major-5\"\n      height=\"100vh\"\n      {...otherProps}\n    >\n      <Pane\n        border\n        margin=\"0 auto\"\n        padding=\"major-5\"\n        fontFamily=\"open sans\"\n        maxWidth=\"1080px\"\n        minHeight=\"640px\"\n      >\n        <Heading use=\"h2\">form selection</Heading>\n        <Set isFilled spacing=\"major-3\" marginTop=\"major-3\">\n          <Tile\n            dashed\n            cursor=\"pointer\"\n            onClick={() => {\n              history.push({ pathname: \"/form\" })\n            }}\n          >\n            <Link href={`#/form`}>\n              <Flex row justifyContent=\"center\">\n                <Box paddingRight=\"major-1\">\n                  <FontAwesomeIcon icon={faPlusCircle} size=\"lg\" />\n                </Box>\n                <Text>New form</Text>\n              </Flex>\n            </Link>\n          </Tile>\n          {localForms &&\n            localForms.map(form => {\n              const now = DateTime.local()\n              const past = DateTime.fromISO(form.updatedAt)\n              const durationText = formatDuration(now.diff(past))\n              return (\n                <Tile\n                  key={form.name}\n                  cursor=\"pointer\"\n                  onClick={() => {\n                    history.push({ pathname: `/form/${form.id}` })\n                  }}\n                >\n                  <Flex column alignItems=\"center\">\n                    <Box marginBottom=\"minor-1\">\n                      <FontAwesomeIcon icon={faFileAlt} size=\"lg\" />\n                    </Box>\n                    <Box marginTop=\"minor-1\" marginBottom=\"minor-1\">\n                      <Link href={`#/form/${form.id}`}>{form.name}</Link>\n                    </Box>\n                    <Text use=\"small\" className=\"small\">\n                      {durationText}\n                    </Text>\n                  </Flex>\n                </Tile>\n              )\n            })}\n        </Set>\n      </Pane>\n    </Box>\n  )\n}\n\nexport const Tile = ({ children, dashed = false, ...otherProps }) => {\n  return (\n    <Flex\n      border={!dashed ? \"1px solid #ccc\" : \"1px dashed #ccc\"}\n      borderRadius=\"8px\"\n      backgroundColor={!dashed ? \"#f7f7f8\" : null}\n      width=\"calc(33.333% - 24px)\"\n      height=\"160px\"\n      padding=\"major-2\"\n      alignItems=\"center\"\n      justifyContent=\"center\"\n      {...otherProps}\n    >\n      {children}\n    </Flex>\n  )\n}\n\nexport const formatDuration = duration => {\n  const pluralize = (value, singular, plural) =>\n    value === 1 ? `${value} ${singular}` : `${value} ${plural}`\n  const timeUnits = {\n    months: [\"month ago\", \"months ago\"],\n    days: [\"day ago\", \"days ago\"],\n    hours: [\"hour ago\", \"hours ago\"],\n    minutes: [\"minute ago\", \"minutes ago\"],\n    seconds: [\"second ago\", \"seconds ago\"],\n  }\n  const timeSpans = duration.shiftTo(...Object.keys(timeUnits)).toObject()\n  for (const timeUnit of Object.keys(timeUnits)) {\n    if (timeSpans[timeUnit]) {\n      return pluralize(round(timeSpans[timeUnit]), ...timeUnits[timeUnit])\n    }\n  }\n  throw new Error(\"format duration could not find a matching time unit\")\n}\n","import React from \"react\"\n\nexport const check = (condition, message = () => \"condition is false\") => {\n  if (!condition) {\n    throw new Error(message())\n  }\n}\n\nexport const checkNotNil = (value, message = () => \"value is nil\") => {\n  if (isNil(value)) {\n    throw new Error(message())\n  }\n}\n\nexport const isNil = value => {\n  return value === null || value === undefined\n}\n\nexport const PrettyCode = ({ value, indent = 2, ...otherProps }) => {\n  return (\n    <pre\n      style={{\n        margin: \"0\",\n        padding: \"0\",\n        color: \"#000\",\n        fontSize: \"13px\",\n        whiteSpace: \"pre-wrap\",\n        wordWrap: \"break-word\",\n      }}\n      {...otherProps}\n    >\n      <code>{pretty(value, indent)}</code>\n    </pre>\n  )\n}\n\nexport const pretty = (value, indent = 2) =>\n  JSON.stringify(value, undefined, indent)\n\nexport const pretty1 = value =>\n  pretty(value, 1)\n    .split(\"\\n\")\n    .map(it => it.trim())\n    .join(\" \")\n\nexport const pretty0 = value => pretty(value, 0)\n","import { produce } from \"immer\"\n\nexport const FORMS_CREATE = Symbol(\"forms/create\")\nexport const FORMS_CREATED = Symbol(\"forms/created\")\n\nexport default store => {\n  store.on(\"@init\", () => {\n    return {\n      forms: {\n        isReady: false,\n      },\n    }\n  })\n\n  store.on(FORMS_CREATE, async state => {\n    store.dispatch(FORMS_CREATED, {})\n  })\n\n  store.on(FORMS_CREATED, (state, {}) => {\n    return produce(state, state => {\n      state.forms.isReady = true\n    })\n  })\n}\n","import React, { Fragment, useEffect, useState } from \"react\"\nimport { Box } from \"fannypack\"\nimport useReactRouter from \"use-react-router\"\nimport useLocalStorage from \"react-use/lib/useLocalStorage\"\nimport FormEditor from \"../components/FormEditor\"\nimport { buildModel, buildFlatModel } from \"../helpers/builder\"\nimport {\n  object,\n  array,\n  string,\n  boolean,\n  integer,\n  number,\n} from \"../helpers/model\"\nimport { pretty } from \"../helpers/utils\"\n\nexport default ({ nested = false, ...otherProps }) => {\n  const { history, location, match } = useReactRouter()\n  const [localForms, setLocalForms] = useLocalStorage(\"monomodel.forms\", null)\n\n  const [formModel, setFormModel] = useState(null)\n  const formPrefs = createFormPrefs()\n  useEffect(() => {\n    if (localForms) {\n      const form = localForms.find(form => String(form.id) === match.params.formId)\n      const formModel = nested\n        ? buildModel(form.schema)\n        : buildFlatModel(form.schema)\n      setFormModel(formModel)\n    }\n  }, [localForms])\n\n  return (\n    <Box\n      backgroundColor=\"#f7f7f8\"\n      paddingLeft=\"major-5\"\n      paddingRight=\"major-5\"\n      paddingBottom=\"major-5\"\n      height=\"100vh\"\n      {...otherProps}\n    >\n      <Box\n        border=\"1px solid #cccccc\"\n        borderTop=\"none\"\n        backgroundColor=\"white\"\n        maxWidth=\"1080px\"\n        margin=\"0 auto\"\n      >\n        {formModel && <FormEditor model={formModel} prefs={formPrefs} />}\n      </Box>\n    </Box>\n  )\n}\n\nconst parentColumns = \"repeat(2, 1fr)\"\nconst fullColumn = \"1 / span 2\"\nconst halfColumn = \"span 1\"\nconst leftColumn = \"1 / span 1\"\nconst rightColumn = \"2 / span 1\"\n\nconst createFormPrefs = () => {\n  const headerStyle = {\n    header: {\n      color: \"#ffffff\",\n      backgroundColor: \"#002245\",\n    },\n  }\n  const bodyStyle = {\n    body: {\n      backgroundColor: \"#fbd9d2\",\n    },\n  }\n  const editStyle = {\n    header: {\n      backgroundColor: \"#fbd9d2\",\n    },\n    body: {\n      backgroundColor: \"#fbd9d2\",\n    },\n  }\n  const formPrefs = {\n    options: {\n      // fontSizesHeader: [\"36px\", \"30px\", \"24px\", \"20px\"],\n    },\n    \"#/\": {\n      // ...headerStyle,\n    },\n    \"#/properties/customer\": {\n      gridTemplateColumns: parentColumns,\n      // ...editStyle,\n    },\n    \"#/properties/customer/properties/customerNumber\": {\n      gridColumn: halfColumn,\n    },\n    \"#/properties/customer/properties/firstName\": {\n      gridColumn: leftColumn,\n    },\n    \"#/properties/customer/properties/lastName\": {\n      gridColumn: halfColumn,\n    },\n    \"#/properties/orderItems\": {\n      // ...headerStyle,\n    },\n    \"#/properties/orderItems/items\": {\n      gridTemplateColumns: parentColumns,\n      // ...headerStyle,\n    },\n    \"#/properties/shippingAddress\": {\n      gridTemplateColumns: parentColumns,\n      // ...headerStyle,\n    },\n  }\n  return formPrefs\n}\n\nexport const orderSchema = object({\n  $schema: \"http://json-schema.org/schema#\",\n  title: \"order\",\n  properties: {\n    orderNumber: string(),\n    orderDate: string(),\n    customer: object({\n      title: \"customer\",\n      properties: {\n        customerNumber: string(),\n        firstName: string(),\n        lastName: string(),\n      },\n    }),\n    orderItems: array({\n      title: \"items\",\n      items: object({\n        title: \"item\",\n        properties: {\n          productNumber: string(),\n          quantity: integer(),\n          unitPrice: integer(),\n        },\n      }),\n    }),\n    shippingAddress: object({\n      title: \"address\",\n      properties: {\n        street: string(),\n        city: string(),\n        country: string(),\n        zip: string(),\n      },\n    }),\n    totalPrice: number(),\n  },\n})\n\nexport const taskSchema = object({\n  title: \"A list of tasks\",\n  required: [\"title\"],\n  properties: {\n    title: string({\n      title: \"Task list title\",\n    }),\n    tasks: array({\n      title: \"Tasks\",\n      items: object({\n        title: \"Task\",\n        required: [\"title\"],\n        properties: {\n          title: string({\n            title: \"Title\",\n            description: \"A sample title\",\n          }),\n          details: string({\n            title: \"Task details\",\n            description: \"Enter the task details\",\n          }),\n          done: boolean({\n            title: \"Done?\",\n            default: false,\n          }),\n        },\n      }),\n    }),\n  },\n})\n","import { schemaWalk } from \"@cloudflare/json-schema-walker\"\nimport { concat } from \"lodash\"\n\nexport const buildDefinition = (type, payload) => {\n  return { type, ...payload }\n}\n\nexport const object = payload => buildDefinition(\"object\", payload)\nexport const array = payload => buildDefinition(\"array\", payload)\nexport const boolean = payload => buildDefinition(\"boolean\", payload)\nexport const string = payload => buildDefinition(\"string\", payload)\nexport const number = payload => buildDefinition(\"number\", payload)\nexport const integer = payload => buildDefinition(\"integer\", payload)\n\nexport const fieldset = (datatype, payload = {}) =>\n  buildDefinition(\"fieldset\", { datatype, ...payload })\nexport const field = (datatype, payload = {}) =>\n  buildDefinition(\"field\", { datatype, ...payload })\n\nexport const taskSchema = object({\n  title: \"A list of tasks\",\n  required: [\"title\"],\n  properties: {\n    title: string({\n      title: \"Task list title\",\n    }),\n    tasks: array({\n      title: \"Tasks\",\n      items: object({\n        required: [\"title\"],\n        properties: {\n          title: string({\n            title: \"Title\",\n            description: \"A sample title\",\n          }),\n          details: string({\n            title: \"Task details\",\n            description: \"Enter the task details\",\n          }),\n          done: boolean({\n            title: \"Done?\",\n            default: false,\n          }),\n        },\n      }),\n    }),\n  },\n})\n\nexport const taskModel = fieldset(\"object\", {\n  pointer: \"#/\",\n  title: \"A list of tasks\",\n  children: [\n    field(\"string\", {\n      pointer: \"#/properties/title\",\n      name: \"title\",\n      title: \"Task list title\",\n    }),\n    fieldset(\"array\", {\n      pointer: \"#/properties/tasks\",\n      name: \"tasks\",\n      title: \"Tasks\",\n      children: [\n        fieldset(\"object\", {\n          pointer: \"#/properties/tasks/items\",\n          name: \"items\",\n          children: [\n            field(\"string\", {\n              pointer: \"#/properties/tasks/items/properties/title\",\n              name: \"title\",\n              title: \"Title\",\n              description: \"A sample title\",\n            }),\n            field(\"string\", {\n              pointer: \"#/properties/tasks/items/properties/details\",\n              name: \"details\",\n              title: \"Task details\",\n              description: \"Enter the task details\",\n            }),\n            field(\"boolean\", {\n              pointer: \"#/properties/tasks/items/properties/done\",\n              name: \"done\",\n              title: \"Done?\",\n              default: false,\n            }),\n          ],\n        }),\n      ],\n    }),\n  ],\n})\n\nexport const orderSchema = object({\n  $schema: \"http://json-schema.org/schema#\",\n  properties: {\n    orderNumber: string(),\n    orderDate: string(),\n    customer: object({\n      properties: {\n        customerNumber: string(),\n        firstName: string(),\n        lastName: string(),\n      },\n    }),\n    orderItems: array({\n      items: object({\n        properties: {\n          productNumber: string(),\n          quantity: integer(),\n          unitPrice: integer(),\n        },\n      }),\n    }),\n    shippingAddress: object({\n      properties: {\n        street: string(),\n        city: string(),\n        country: string(),\n        zip: string(),\n      },\n    }),\n    totalPrice: number(),\n  },\n})\n\nexport const fetchSchemaPaths = schema => {\n  const schemaPaths = []\n  schemaWalk(schema, (schemaObject, path, parentSchemaObject, parentPath) => {\n    schemaPaths.push({\n      type: schemaObject.type,\n      path,\n      parentPath,\n      fullPath: concat(parentPath, path),\n    })\n  })\n  return schemaPaths\n}\n","import React, { Fragment } from \"react\"\nimport ReactDOM from \"react-dom\"\nimport ApplicationContainer from \"./components/ApplicationContainer\"\n\nconst rootNode = document.querySelector(\"#root\")\nReactDOM.render(\n  <Fragment>\n    <ApplicationContainer />\n  </Fragment>,\n  rootNode\n)\n","import React, { Fragment } from \"react\"\nimport { HashRouter, Route, Switch } from \"react-router-dom\"\nimport { ThemeProvider, css, defaultTheme } from \"fannypack\"\nimport { StoreContextProvider } from \"../store\"\nimport { FormDesigner, TileSelector } from \"../pages\"\n\nexport default () => {\n  return (\n    <ApplicationContextProvider>\n      <ApplicationRoutes />\n    </ApplicationContextProvider>\n  )\n}\n\nexport const ApplicationRoutes = () => {\n  return (\n    <HashRouter>\n      <Switch>\n        <Route exact path=\"/\" component={TileSelector} />\n        <Route path=\"/form/:formId\" component={FormDesigner} />\n      </Switch>\n    </HashRouter>\n  )\n}\n\nexport const ApplicationContext = React.createContext({})\n\nexport const ApplicationContextProvider = ({\n  children,\n  theme = applicationTheme,\n}) => {\n  return (\n    <StoreContextProvider>\n      <ThemeProvider theme={theme} isStandalone>\n        <Fragment>{children}</Fragment>\n      </ThemeProvider>\n    </StoreContextProvider>\n  )\n}\n\nexport const applicationTheme = defaultTheme({\n  global: {\n    base: css`\n      body,\n      #root {\n        margin: 0;\n        height: 100vh;\n        color: #121212;\n      }\n    `,\n  },\n  Pane: {\n    base: css`\n      border-radius: 0;\n    `,\n  },\n  Heading: {\n    base: css`\n      font-family: \"open sans condensed\", sans-serif;\n      font-size: 22px;\n      color: #121212;\n    `,\n  },\n  Text: {\n    base: css`\n      &.small {\n        font-size: 0.8rem;\n      }\n    `\n  },\n  Link: {\n    base: css`\n      text-decoration: unset;\n    `,\n  },\n})\n"],"sourceRoot":""}